values=c("#37697E","#62C5E5","#96DBF6","#57A9A0","#F14F3B","#8A3E31")
)+ #https://html-color-codes.info/colors-from-image/
theme_minimal()+
theme(plot.title = element_text(size=15,vjust=3.2),
plot.caption = element_text(size=11, color="#333333", vjust=-1.2, hjust=0),
legend.position = c(0.36,1),
legend.direction = "horizontal",
legend.text = element_text(size=11,color="#333333"),
axis.title.x = element_text(vjust = -1.5,color="#333333"),
axis.title.y = element_text(vjust = 2.5,color="#333333"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color = "#BAB7B7"),
panel.grid.minor.y = element_blank())+
guides(col=guide_legend(nrow = 1))
ggplot(dataset2, aes(x=CPI, y=HDI))+
geom_smooth(aes(group = 1),method="lm", formula=y~log(x),se=FALSE,color="red")+
geom_point(aes(color = Region), shape=21, size=4,fill="white", stroke=T)+
geom_text_repel(aes(label=Country),data=subs, color="#333333",nudge_y=0.03)+
geom_text_repel(aes(label=Country),data=subs2, color="#333333",nudge_y=0.07,nudge_x=-0.04)+
geom_text_repel(aes(label=Country),data=subs3, color="#333333",nudge_y=0.05)+
geom_text_repel(aes(label=Country),data=subs4, color="#333333",nudge_y=-0.04,nudge_x=0.05)+
geom_text_repel(aes(label=Country),data=subs5, color="#333333",nudge_y=0.04,nudge_x=0.05)+
ggtitle(expression(bold("Corruption and human development")))+
labs(caption="Source: Transparency International; UN Human Development Report",
color="#333333")+
scale_x_continuous(name = expression(italic(
"Corruption Perceptions Index, 2011 (10=least corrupt)")),
breaks=seq(1,10,by=1),
limits=c(1,10))+
scale_y_continuous(name = expression(italic("Human Development Index, 2011 (1=best)")),
breaks=seq(0.2,1.0,by=0.1),
limits=c(0.2,1.0))+
scale_fill_discrete(limits = c("OECD","Americas","Asia &\nOceania","Central &\nEastern Europe",
"Middle East &\nNorth Africa","Sub-Saharan\nAfrica"))+
scale_color_manual(name="",
values=c("#37697E","#62C5E5","#96DBF6","#57A9A0","#F14F3B","#8A3E31")
)+ #https://html-color-codes.info/colors-from-image/
theme_minimal()+
theme(plot.title = element_text(size=15,vjust=3.2),
plot.caption = element_text(size=11, color="#333333", vjust=-1.2, hjust=0),
legend.position = c(0.36,1),
legend.direction = "horizontal",
legend.text = element_text(size=11,color="#333333"),
axis.title.x = element_text(vjust = -1.5,color="#333333"),
axis.title.y = element_text(vjust = 2.5,color="#333333"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color = "#BAB7B7"),
panel.grid.minor.y = element_blank())+
guides(col=guide_legend(nrow = 1))
grid.segments(x0 = 0.76, x1 = 0.78, y0 = 0.935, y1 = 0.935, gp = gpar(col = "red",lwd=2),
draw = TRUE)
grid.text("R?=56%",draw=T,just="left",x=0.79,y=0.94,gp=gpar(col="#333333",fontsize=11))
grid.segments(x0 = 0.092, x1 = 0.946, y0 = 0.1, y1 = 0.1, gp = gpar(col = "#BAB7B7"),
draw = TRUE)
for (i in 1:10) {
grid.segments(x0 = 0.092*i+0.003*(i-1), x1 =0.092*i+0.003*(i-1), y0 = 0.1, y1 = 0.105,
gp = gpar(col = "#BAB7B7"),
draw = TRUE)
}
ggplot(dataset2, aes(x=CPI, y=HDI))+
geom_smooth(method="lm", formula=y~log(x),se=FALSE,color="red")+
geom_point(aes(color = Region), shape=21, size=4,fill="white", stroke=T)+
geom_text_repel(aes(label=Country),data=subs, color="#333333",nudge_y=0.03)+
geom_text_repel(aes(label=Country),data=subs2, color="#333333",nudge_y=0.07,nudge_x=-0.04)+
geom_text_repel(aes(label=Country),data=subs3, color="#333333",nudge_y=0.05)+
geom_text_repel(aes(label=Country),data=subs4, color="#333333",nudge_y=-0.04,nudge_x=0.05)+
geom_text_repel(aes(label=Country),data=subs5, color="#333333",nudge_y=0.04,nudge_x=0.05)+
ggtitle(expression(bold("Corruption and human development")))+
labs(caption="Source: Transparency International; UN Human Development Report",
color="#333333")+
scale_x_continuous(name = expression(italic(
"Corruption Perceptions Index, 2011 (10=least corrupt)")),
breaks=seq(1,10,by=1),
limits=c(1,10))+
scale_y_continuous(name = expression(italic("Human Development Index, 2011 (1=best)")),
breaks=seq(0.2,1.0,by=0.1),
limits=c(0.2,1.0))+
scale_fill_discrete(limits = c("OECD","Americas","Asia &\nOceania","Central &\nEastern Europe",
"Middle East &\nNorth Africa","Sub-Saharan\nAfrica"))+
scale_color_manual(name="",
values=c("#37697E","#62C5E5","#96DBF6","#57A9A0","#F14F3B","#8A3E31")
)+ #https://html-color-codes.info/colors-from-image/
theme_minimal()+
theme(plot.title = element_text(size=15,vjust=3.2),
plot.caption = element_text(size=11, color="#333333", vjust=-1.2, hjust=0),
legend.position = c(0.36,1),
legend.direction = "horizontal",
legend.text = element_text(size=11,color="#333333"),
axis.title.x = element_text(vjust = -1.5,color="#333333"),
axis.title.y = element_text(vjust = 2.5,color="#333333"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color = "#BAB7B7"),
panel.grid.minor.y = element_blank())+
guides(col=guide_legend(nrow = 1))
ggplot(dataset2, aes(x=CPI, y=HDI))+
geom_smooth(aes(group = 1),method="lm", formula=y~log(x),se=FALSE,color="red")+
geom_point(aes(color = Region), shape=21, size=4,fill="white", stroke=T)+
geom_text_repel(aes(label=Country),data=subs, color="#333333",nudge_y=0.03)+
geom_text_repel(aes(label=Country),data=subs2, color="#333333",nudge_y=0.07,nudge_x=-0.04)+
geom_text_repel(aes(label=Country),data=subs3, color="#333333",nudge_y=0.05)+
geom_text_repel(aes(label=Country),data=subs4, color="#333333",nudge_y=-0.04,nudge_x=0.05)+
geom_text_repel(aes(label=Country),data=subs5, color="#333333",nudge_y=0.04,nudge_x=0.05)+
ggtitle(expression(bold("Corruption and human development")))+
labs(caption="Source: Transparency International; UN Human Development Report",
color="#333333")+
scale_x_continuous(name = expression(italic(
"Corruption Perceptions Index, 2011 (10=least corrupt)")),
breaks=seq(1,10,by=1),
limits=c(1,10))+
scale_y_continuous(name = expression(italic("Human Development Index, 2011 (1=best)")),
breaks=seq(0.2,1.0,by=0.1),
limits=c(0.2,1.0))+
scale_fill_discrete(limits = c("OECD","Americas","Asia &\nOceania","Central &\nEastern Europe",
"Middle East &\nNorth Africa","Sub-Saharan\nAfrica"))+
scale_color_manual(name="",
values=c("#37697E","#62C5E5","#96DBF6","#57A9A0","#F14F3B","#8A3E31")
)+ #https://html-color-codes.info/colors-from-image/
theme_minimal()+
theme(plot.title = element_text(size=15,vjust=3.2),
plot.caption = element_text(size=11, color="#333333", vjust=-1.2, hjust=0),
legend.position = c(0.36,1),
legend.direction = "horizontal",
legend.text = element_text(size=11,color="#333333"),
axis.title.x = element_text(vjust = -1.5,color="#333333"),
axis.title.y = element_text(vjust = 2.5,color="#333333"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color = "#BAB7B7"),
panel.grid.minor.y = element_blank())+
guides(col=guide_legend(nrow = 1))
ggplot(dataset2, aes(x=CPI, y=HDI))+
geom_point(aes(color = Region), shape=21, size=7,fill="white", stroke=22)+
geom_smooth(aes(group = 1),method="lm", formula=y~log(x),se=FALSE,color="red")+
geom_text_repel(aes(label=Country),data=subs, color="#333333",nudge_y=0.03)+
geom_text_repel(aes(label=Country),data=subs2, color="#333333",nudge_y=0.07,nudge_x=-0.04)+
geom_text_repel(aes(label=Country),data=subs3, color="#333333",nudge_y=0.05)+
geom_text_repel(aes(label=Country),data=subs4, color="#333333",nudge_y=-0.04,nudge_x=0.05)+
geom_text_repel(aes(label=Country),data=subs5, color="#333333",nudge_y=0.04,nudge_x=0.05)+
ggtitle(expression(bold("Corruption and human development")))+
labs(caption="Source: Transparency International; UN Human Development Report",
color="#333333")+
scale_x_continuous(name = expression(italic(
"Corruption Perceptions Index, 2011 (10=least corrupt)")),
breaks=seq(1,10,by=1),
limits=c(1,10))+
scale_y_continuous(name = expression(italic("Human Development Index, 2011 (1=best)")),
breaks=seq(0.2,1.0,by=0.1),
limits=c(0.2,1.0))+
scale_fill_discrete(limits = c("OECD","Americas","Asia &\nOceania","Central &\nEastern Europe",
"Middle East &\nNorth Africa","Sub-Saharan\nAfrica"))+
scale_color_manual(name="",
values=c("#37697E","#62C5E5","#96DBF6","#57A9A0","#F14F3B","#8A3E31")
)+ #https://html-color-codes.info/colors-from-image/
theme_minimal()+
theme(plot.title = element_text(size=15,vjust=3.2),
plot.caption = element_text(size=11, color="#333333", vjust=-1.2, hjust=0),
legend.position = c(0.36,1),
legend.direction = "horizontal",
legend.text = element_text(size=11,color="#333333"),
axis.title.x = element_text(vjust = -1.5,color="#333333"),
axis.title.y = element_text(vjust = 2.5,color="#333333"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color = "#BAB7B7"),
panel.grid.minor.y = element_blank())+
guides(col=guide_legend(nrow = 1))
ggplot(dataset2, aes(x=CPI, y=HDI))+
geom_point(aes(color = Region), shape=21, size=7,fill="white", stroke=T)+
geom_smooth(aes(group = 1),method="lm", formula=y~log(x),se=FALSE,color="red")+
geom_text_repel(aes(label=Country),data=subs, color="#333333",nudge_y=0.03)+
geom_text_repel(aes(label=Country),data=subs2, color="#333333",nudge_y=0.07,nudge_x=-0.04)+
geom_text_repel(aes(label=Country),data=subs3, color="#333333",nudge_y=0.05)+
geom_text_repel(aes(label=Country),data=subs4, color="#333333",nudge_y=-0.04,nudge_x=0.05)+
geom_text_repel(aes(label=Country),data=subs5, color="#333333",nudge_y=0.04,nudge_x=0.05)+
ggtitle(expression(bold("Corruption and human development")))+
labs(caption="Source: Transparency International; UN Human Development Report",
color="#333333")+
scale_x_continuous(name = expression(italic(
"Corruption Perceptions Index, 2011 (10=least corrupt)")),
breaks=seq(1,10,by=1),
limits=c(1,10))+
scale_y_continuous(name = expression(italic("Human Development Index, 2011 (1=best)")),
breaks=seq(0.2,1.0,by=0.1),
limits=c(0.2,1.0))+
scale_fill_discrete(limits = c("OECD","Americas","Asia &\nOceania","Central &\nEastern Europe",
"Middle East &\nNorth Africa","Sub-Saharan\nAfrica"))+
scale_color_manual(name="",
values=c("#37697E","#62C5E5","#96DBF6","#57A9A0","#F14F3B","#8A3E31")
)+ #https://html-color-codes.info/colors-from-image/
theme_minimal()+
theme(plot.title = element_text(size=15,vjust=3.2),
plot.caption = element_text(size=11, color="#333333", vjust=-1.2, hjust=0),
legend.position = c(0.36,1),
legend.direction = "horizontal",
legend.text = element_text(size=11,color="#333333"),
axis.title.x = element_text(vjust = -1.5,color="#333333"),
axis.title.y = element_text(vjust = 2.5,color="#333333"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color = "#BAB7B7"),
panel.grid.minor.y = element_blank())+
guides(col=guide_legend(nrow = 1))
ggplot(dataset2, aes(x=CPI, y=HDI))+
geom_point(aes(color = Region), shape=21, size=5,fill="white", stroke=T)+
geom_smooth(aes(group = 1),method="lm", formula=y~log(x),se=FALSE,color="red")+
geom_text_repel(aes(label=Country),data=subs, color="#333333",nudge_y=0.03)+
geom_text_repel(aes(label=Country),data=subs2, color="#333333",nudge_y=0.07,nudge_x=-0.04)+
geom_text_repel(aes(label=Country),data=subs3, color="#333333",nudge_y=0.05)+
geom_text_repel(aes(label=Country),data=subs4, color="#333333",nudge_y=-0.04,nudge_x=0.05)+
geom_text_repel(aes(label=Country),data=subs5, color="#333333",nudge_y=0.04,nudge_x=0.05)+
ggtitle(expression(bold("Corruption and human development")))+
labs(caption="Source: Transparency International; UN Human Development Report",
color="#333333")+
scale_x_continuous(name = expression(italic(
"Corruption Perceptions Index, 2011 (10=least corrupt)")),
breaks=seq(1,10,by=1),
limits=c(1,10))+
scale_y_continuous(name = expression(italic("Human Development Index, 2011 (1=best)")),
breaks=seq(0.2,1.0,by=0.1),
limits=c(0.2,1.0))+
scale_fill_discrete(limits = c("OECD","Americas","Asia &\nOceania","Central &\nEastern Europe",
"Middle East &\nNorth Africa","Sub-Saharan\nAfrica"))+
scale_color_manual(name="",
values=c("#37697E","#62C5E5","#96DBF6","#57A9A0","#F14F3B","#8A3E31")
)+ #https://html-color-codes.info/colors-from-image/
theme_minimal()+
theme(plot.title = element_text(size=15,vjust=3.2),
plot.caption = element_text(size=11, color="#333333", vjust=-1.2, hjust=0),
legend.position = c(0.36,1),
legend.direction = "horizontal",
legend.text = element_text(size=11,color="#333333"),
axis.title.x = element_text(vjust = -1.5,color="#333333"),
axis.title.y = element_text(vjust = 2.5,color="#333333"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color = "#BAB7B7"),
panel.grid.minor.y = element_blank())+
guides(col=guide_legend(nrow = 1))
source('~/Programming/UCA_MSc-DS1/processing_datasets_with_R/lecture_3/exercises/lecture_3_exercises.R', echo=TRUE)
grid.text("R²=56%",draw=T,just="left",x=0.79,y=0.94,gp=gpar(col="#333333",fontsize=11))
ggplot(dataset2, aes(x=CPI, y=HDI))+
geom_point(aes(color = Region), shape=20, size=7)+
geom_point(aes(color = Region), shape=20, size=4, color="white")+
geom_smooth(aes(group = 1),method="lm", formula=y~log(x),se=FALSE,color="red")+
geom_text_repel(aes(label=Country),data=subs, color="#333333",nudge_y=0.03)+
geom_text_repel(aes(label=Country),data=subs2, color="#333333",nudge_y=0.07,nudge_x=-0.04)+
geom_text_repel(aes(label=Country),data=subs3, color="#333333",nudge_y=0.05)+
geom_text_repel(aes(label=Country),data=subs4, color="#333333",nudge_y=-0.04,nudge_x=0.05)+
geom_text_repel(aes(label=Country),data=subs5, color="#333333",nudge_y=0.04,nudge_x=0.05)+
ggtitle(expression(bold("Corruption and human development")))+
labs(caption="Source: Transparency International; UN Human Development Report",
color="#333333")+
scale_x_continuous(name = expression(italic(
"Corruption Perceptions Index, 2011 (10=least corrupt)")),
breaks=seq(1,10,by=1),
limits=c(1,10))+
scale_y_continuous(name = expression(italic("Human Development Index, 2011 (1=best)")),
breaks=seq(0.2,1.0,by=0.1),
limits=c(0.2,1.0))+
scale_fill_discrete(limits = c("OECD","Americas","Asia &\nOceania","Central &\nEastern Europe",
"Middle East &\nNorth Africa","Sub-Saharan\nAfrica"))+
scale_color_manual(name="",
values=c("#37697E","#62C5E5","#96DBF6","#57A9A0","#F14F3B","#8A3E31")
)+ #https://html-color-codes.info/colors-from-image/
theme_minimal()+
theme(plot.title = element_text(size=15,vjust=3.2),
plot.caption = element_text(size=11, color="#333333", vjust=-1.2, hjust=0),
legend.position = c(0.36,1),
legend.direction = "horizontal",
legend.text = element_text(size=11,color="#333333"),
axis.title.x = element_text(vjust = -1.5,color="#333333"),
axis.title.y = element_text(vjust = 2.5,color="#333333"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color = "#BAB7B7"),
panel.grid.minor.y = element_blank())+
guides(col=guide_legend(nrow = 1))
grid.segments(x0 = 0.76, x1 = 0.78, y0 = 0.935, y1 = 0.935, gp = gpar(col = "red",lwd=2),
draw = TRUE)
grid.text("R²=56%",draw=T,just="left",x=0.79,y=0.94,gp=gpar(col="#333333",fontsize=11))
grid.segments(x0 = 0.092, x1 = 0.946, y0 = 0.1, y1 = 0.1, gp = gpar(col = "#BAB7B7"),
draw = TRUE)
for (i in 1:10) {
grid.segments(x0 = 0.092*i+0.003*(i-1), x1 =0.092*i+0.003*(i-1), y0 = 0.1, y1 = 0.105,
gp = gpar(col = "#BAB7B7"),
draw = TRUE)
}
ggplot(dataset2, aes(x=CPI, y=HDI))+
geom_point(aes(color = Region), shape=20, size=7)+
geom_point(aes(color = Region), shape=20, size=4, color="white")+
geom_smooth(aes(group = 1),method="lm", formula=y~poly(x, (100/56)^2),se=FALSE,color="red")+
geom_text_repel(aes(label=Country),data=subs, color="#333333",nudge_y=0.03)+
geom_text_repel(aes(label=Country),data=subs2, color="#333333",nudge_y=0.07,nudge_x=-0.04)+
geom_text_repel(aes(label=Country),data=subs3, color="#333333",nudge_y=0.05)+
geom_text_repel(aes(label=Country),data=subs4, color="#333333",nudge_y=-0.04,nudge_x=0.05)+
geom_text_repel(aes(label=Country),data=subs5, color="#333333",nudge_y=0.04,nudge_x=0.05)+
ggtitle(expression(bold("Corruption and human development")))+
labs(caption="Source: Transparency International; UN Human Development Report",
color="#333333")+
scale_x_continuous(name = expression(italic(
"Corruption Perceptions Index, 2011 (10=least corrupt)")),
breaks=seq(1,10,by=1),
limits=c(1,10))+
scale_y_continuous(name = expression(italic("Human Development Index, 2011 (1=best)")),
breaks=seq(0.2,1.0,by=0.1),
limits=c(0.2,1.0))+
scale_fill_discrete(limits = c("OECD","Americas","Asia &\nOceania","Central &\nEastern Europe",
"Middle East &\nNorth Africa","Sub-Saharan\nAfrica"))+
scale_color_manual(name="",
values=c("#37697E","#62C5E5","#96DBF6","#57A9A0","#F14F3B","#8A3E31")
)+ #https://html-color-codes.info/colors-from-image/
theme_minimal()+
theme(plot.title = element_text(size=15,vjust=3.2),
plot.caption = element_text(size=11, color="#333333", vjust=-1.2, hjust=0),
legend.position = c(0.36,1),
legend.direction = "horizontal",
legend.text = element_text(size=11,color="#333333"),
axis.title.x = element_text(vjust = -1.5,color="#333333"),
axis.title.y = element_text(vjust = 2.5,color="#333333"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color = "#BAB7B7"),
panel.grid.minor.y = element_blank())+
guides(col=guide_legend(nrow = 1))
ggplot(dataset2, aes(x=CPI, y=HDI))+
geom_smooth(aes(group = 1),method="lm", formula=y~log(x),se=FALSE,color="red")+
geom_point(aes(color = Region), shape=20, size=7)+
geom_point(aes(color = Region), shape=20, size=4, color="white")+
geom_text_repel(aes(label=Country),data=subs, color="#333333",nudge_y=0.03)+
geom_text_repel(aes(label=Country),data=subs2, color="#333333",nudge_y=0.07,nudge_x=-0.04)+
geom_text_repel(aes(label=Country),data=subs3, color="#333333",nudge_y=0.05)+
geom_text_repel(aes(label=Country),data=subs4, color="#333333",nudge_y=-0.04,nudge_x=0.05)+
geom_text_repel(aes(label=Country),data=subs5, color="#333333",nudge_y=0.04,nudge_x=0.05)+
ggtitle(expression(bold("Corruption and human development")))+
labs(caption="Source: Transparency International; UN Human Development Report",
color="#333333")+
scale_x_continuous(name = expression(italic(
"Corruption Perceptions Index, 2011 (10=least corrupt)")),
breaks=seq(1,10,by=1),
limits=c(1,10))+
scale_y_continuous(name = expression(italic("Human Development Index, 2011 (1=best)")),
breaks=seq(0.2,1.0,by=0.1),
limits=c(0.2,1.0))+
scale_fill_discrete(limits = c("OECD","Americas","Asia &\nOceania","Central &\nEastern Europe",
"Middle East &\nNorth Africa","Sub-Saharan\nAfrica"))+
scale_color_manual(name="",
values=c("#37697E","#62C5E5","#96DBF6","#57A9A0","#F14F3B","#8A3E31")
)+ #https://html-color-codes.info/colors-from-image/
theme_minimal()+
theme(plot.title = element_text(size=15,vjust=3.2),
plot.caption = element_text(size=11, color="#333333", vjust=-1.2, hjust=0),
legend.position = c(0.36,1),
legend.direction = "horizontal",
legend.text = element_text(size=11,color="#333333"),
axis.title.x = element_text(vjust = -1.5,color="#333333"),
axis.title.y = element_text(vjust = 2.5,color="#333333"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color = "#BAB7B7"),
panel.grid.minor.y = element_blank())+
guides(col=guide_legend(nrow = 1))
grid.segments(x0 = 0.76, x1 = 0.78, y0 = 0.935, y1 = 0.935, gp = gpar(col = "red",lwd=2),
draw = TRUE)
grid.text("R²=56%",draw=T,just="left",x=0.79,y=0.94,gp=gpar(col="#333333",fontsize=11))
grid.segments(x0 = 0.092, x1 = 0.946, y0 = 0.1, y1 = 0.1, gp = gpar(col = "#BAB7B7"),
draw = TRUE)
for (i in 1:10) {
grid.segments(x0 = 0.092*i+0.003*(i-1), x1 =0.092*i+0.003*(i-1), y0 = 0.1, y1 = 0.105,
gp = gpar(col = "#BAB7B7"),
draw = TRUE)
}
ggplot(dataset2, aes(x=CPI, y=HDI))+
geom_smooth(aes(group = 1),method="lm", formula=y~log(x),se=FALSE,color="red")+
geom_point(aes(color = Region), shape=21, size=5,stroke=T,fill="white")+
geom_text_repel(aes(label=Country),data=subs, color="#333333",nudge_y=0.03)+
geom_text_repel(aes(label=Country),data=subs2, color="#333333",nudge_y=0.07,nudge_x=-0.04)+
geom_text_repel(aes(label=Country),data=subs3, color="#333333",nudge_y=0.05)+
geom_text_repel(aes(label=Country),data=subs4, color="#333333",nudge_y=-0.04,nudge_x=0.05)+
geom_text_repel(aes(label=Country),data=subs5, color="#333333",nudge_y=0.04,nudge_x=0.05)+
ggtitle(expression(bold("Corruption and human development")))+
labs(caption="Source: Transparency International; UN Human Development Report",
color="#333333")+
scale_x_continuous(name = expression(italic(
"Corruption Perceptions Index, 2011 (10=least corrupt)")),
breaks=seq(1,10,by=1),
limits=c(1,10))+
scale_y_continuous(name = expression(italic("Human Development Index, 2011 (1=best)")),
breaks=seq(0.2,1.0,by=0.1),
limits=c(0.2,1.0))+
scale_fill_discrete(limits = c("OECD","Americas","Asia &\nOceania","Central &\nEastern Europe",
"Middle East &\nNorth Africa","Sub-Saharan\nAfrica"))+
scale_color_manual(name="",
values=c("#37697E","#62C5E5","#96DBF6","#57A9A0","#F14F3B","#8A3E31")
)+ #https://html-color-codes.info/colors-from-image/
theme_minimal()+
theme(plot.title = element_text(size=15,vjust=3.2),
plot.caption = element_text(size=11, color="#333333", vjust=-1.2, hjust=0),
legend.position = c(0.36,1),
legend.direction = "horizontal",
legend.text = element_text(size=11,color="#333333"),
axis.title.x = element_text(vjust = -1.5,color="#333333"),
axis.title.y = element_text(vjust = 2.5,color="#333333"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color = "#BAB7B7"),
panel.grid.minor.y = element_blank())+
guides(col=guide_legend(nrow = 1))
grid.segments(x0 = 0.76, x1 = 0.78, y0 = 0.935, y1 = 0.935, gp = gpar(col = "red",lwd=2),
draw = TRUE)
grid.text("R²=56%",draw=T,just="left",x=0.79,y=0.94,gp=gpar(col="#333333",fontsize=11))
grid.segments(x0 = 0.092, x1 = 0.946, y0 = 0.1, y1 = 0.1, gp = gpar(col = "#BAB7B7"),
draw = TRUE)
for (i in 1:10) {
grid.segments(x0 = 0.092*i+0.003*(i-1), x1 =0.092*i+0.003*(i-1), y0 = 0.1, y1 = 0.105,
gp = gpar(col = "#BAB7B7"),
draw = TRUE)
}
ggplot(dataset2, aes(x=CPI, y=HDI))+
geom_smooth(aes(group = 1),method="lm", formula=y~log(x),se=FALSE,color="red")+
geom_point(aes(color = Region), shape=21, size=4,stroke=T,fill="white")+
geom_text_repel(aes(label=Country),data=subs, color="#333333",nudge_y=0.03)+
geom_text_repel(aes(label=Country),data=subs2, color="#333333",nudge_y=0.07,nudge_x=-0.04)+
geom_text_repel(aes(label=Country),data=subs3, color="#333333",nudge_y=0.05)+
geom_text_repel(aes(label=Country),data=subs4, color="#333333",nudge_y=-0.04,nudge_x=0.05)+
geom_text_repel(aes(label=Country),data=subs5, color="#333333",nudge_y=0.04,nudge_x=0.05)+
ggtitle(expression(bold("Corruption and human development")))+
labs(caption="Source: Transparency International; UN Human Development Report",
color="#333333")+
scale_x_continuous(name = expression(italic(
"Corruption Perceptions Index, 2011 (10=least corrupt)")),
breaks=seq(1,10,by=1),
limits=c(1,10))+
scale_y_continuous(name = expression(italic("Human Development Index, 2011 (1=best)")),
breaks=seq(0.2,1.0,by=0.1),
limits=c(0.2,1.0))+
scale_fill_discrete(limits = c("OECD","Americas","Asia &\nOceania","Central &\nEastern Europe",
"Middle East &\nNorth Africa","Sub-Saharan\nAfrica"))+
scale_color_manual(name="",
values=c("#37697E","#62C5E5","#96DBF6","#57A9A0","#F14F3B","#8A3E31")
)+ #https://html-color-codes.info/colors-from-image/
theme_minimal()+
theme(plot.title = element_text(size=15,vjust=3.2),
plot.caption = element_text(size=11, color="#333333", vjust=-1.2, hjust=0),
legend.position = c(0.36,1),
legend.direction = "horizontal",
legend.text = element_text(size=11,color="#333333"),
axis.title.x = element_text(vjust = -1.5,color="#333333"),
axis.title.y = element_text(vjust = 2.5,color="#333333"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color = "#BAB7B7"),
panel.grid.minor.y = element_blank())+
guides(col=guide_legend(nrow = 1))
grid.segments(x0 = 0.76, x1 = 0.78, y0 = 0.935, y1 = 0.935, gp = gpar(col = "red",lwd=2),
draw = TRUE)
grid.text("R²=56%",draw=T,just="left",x=0.79,y=0.94,gp=gpar(col="#333333",fontsize=11))
grid.segments(x0 = 0.092, x1 = 0.946, y0 = 0.1, y1 = 0.1, gp = gpar(col = "#BAB7B7"),
draw = TRUE)
for (i in 1:10) {
grid.segments(x0 = 0.092*i+0.003*(i-1), x1 =0.092*i+0.003*(i-1), y0 = 0.1, y1 = 0.105,
gp = gpar(col = "#BAB7B7"),
draw = TRUE)
}
ggplot(dataset2, aes(x=CPI, y=HDI))+
geom_smooth(aes(group = 1),method="lm", formula=y~log(x),se=FALSE,color="red")+
geom_point(aes(color = Region), shape=21, size=4,stroke=TRUE,fill="white")+
geom_text_repel(aes(label=Country),data=subs, color="#333333",nudge_y=0.03)+
geom_text_repel(aes(label=Country),data=subs2, color="#333333",nudge_y=0.07,nudge_x=-0.04)+
geom_text_repel(aes(label=Country),data=subs3, color="#333333",nudge_y=0.05)+
geom_text_repel(aes(label=Country),data=subs4, color="#333333",nudge_y=-0.04,nudge_x=0.05)+
geom_text_repel(aes(label=Country),data=subs5, color="#333333",nudge_y=0.04,nudge_x=0.05)+
ggtitle(expression(bold("Corruption and human development")))+
labs(caption="Source: Transparency International; UN Human Development Report",
color="#333333")+
scale_x_continuous(name = expression(italic(
"Corruption Perceptions Index, 2011 (10=least corrupt)")),
breaks=seq(1,10,by=1),
limits=c(1,10))+
scale_y_continuous(name = expression(italic("Human Development Index, 2011 (1=best)")),
breaks=seq(0.2,1.0,by=0.1),
limits=c(0.2,1.0))+
scale_fill_discrete(limits = c("OECD","Americas","Asia &\nOceania","Central &\nEastern Europe",
"Middle East &\nNorth Africa","Sub-Saharan\nAfrica"))+
scale_color_manual(name="",
values=c("#37697E","#62C5E5","#96DBF6","#57A9A0","#F14F3B","#8A3E31")
)+ #https://html-color-codes.info/colors-from-image/
theme_minimal()+
theme(plot.title = element_text(size=15,vjust=3.2),
plot.caption = element_text(size=11, color="#333333", vjust=-1.2, hjust=0),
legend.position = c(0.36,1),
legend.direction = "horizontal",
legend.text = element_text(size=11,color="#333333"),
axis.title.x = element_text(vjust = -1.5,color="#333333"),
axis.title.y = element_text(vjust = 2.5,color="#333333"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color = "#BAB7B7"),
panel.grid.minor.y = element_blank())+
guides(col=guide_legend(nrow = 1))
grid.segments(x0 = 0.76, x1 = 0.78, y0 = 0.935, y1 = 0.935, gp = gpar(col = "red",lwd=2),
draw = TRUE)
grid.text("R²=56%",draw=T,just="left",x=0.79,y=0.94,gp=gpar(col="#333333",fontsize=11))
grid.segments(x0 = 0.092, x1 = 0.946, y0 = 0.1, y1 = 0.1, gp = gpar(col = "#BAB7B7"),
draw = TRUE)
for (i in 1:10) {
grid.segments(x0 = 0.092*i+0.003*(i-1), x1 =0.092*i+0.003*(i-1), y0 = 0.1, y1 = 0.105,
gp = gpar(col = "#BAB7B7"),
draw = TRUE)
}
